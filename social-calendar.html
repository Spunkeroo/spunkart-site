<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Social Media Content Calendar | Free Post Planner - SpunkArt</title>
<meta name="description" content="Free social media content calendar. Plan, schedule, and organize posts across Twitter/X, Instagram, LinkedIn, TikTok, Facebook, and YouTube. Visual calendar with templates, drag-and-drop, and CSV export.">
<meta name="keywords" content="social media calendar, content planner, post scheduler, social media planner, content calendar tool, free social media tool">
<link rel="canonical" href="https://spunkart.com/social-calendar">
<meta property="og:title" content="Social Media Content Calendar | Free Post Planner">
<meta property="og:description" content="Plan and organize social media posts across all platforms. Visual calendar with templates, color coding, and CSV export. 100% free.">
<meta property="og:url" content="https://spunkart.com/social-calendar">
<meta property="og:type" content="website">
<meta property="og:image" content="https://spunkart.com/images/social-calendar-og.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Social Media Content Calendar | Free Post Planner">
<meta name="twitter:description" content="Plan and organize social media posts across all platforms. Visual calendar with templates, color coding, and CSV export. 100% free.">
<meta name="twitter:site" content="@SpunkArt13">
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"WebApplication",
  "name":"Social Media Content Calendar",
  "description":"Free social media content calendar for planning posts across Twitter/X, Instagram, LinkedIn, TikTok, Facebook, and YouTube.",
  "url":"https://spunkart.com/social-calendar",
  "applicationCategory":"BusinessApplication",
  "operatingSystem":"Any",
  "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
  "author":{"@type":"Organization","name":"SpunkArt","url":"https://spunkart.com"}
}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{background:#0a0a0a;color:#e8e8e8;font-family:system-ui,-apple-system,sans-serif;min-height:100vh;line-height:1.5}
a{color:#ff5f1f;text-decoration:none}
a:hover{text-decoration:underline}
::selection{background:#ff5f1f;color:#fff}
::-webkit-scrollbar{width:6px}
::-webkit-scrollbar-track{background:#111}
::-webkit-scrollbar-thumb{background:#333;border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:#555}

/* Nav */
.nav{background:#111;border-bottom:1px solid #222;padding:12px 24px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100}
.nav-left{display:flex;align-items:center;gap:16px}
.nav-brand{font-size:20px;font-weight:700;color:#ff5f1f}
.nav-back{color:#888;font-size:14px;transition:color .2s}
.nav-back:hover{color:#ff5f1f;text-decoration:none}

/* Layout */
.app-container{max-width:1200px;margin:0 auto;padding:20px;display:flex;gap:20px}
.main-area{flex:1;min-width:0}
.sidebar{width:280px;flex-shrink:0}

/* Header */
.cal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px}
.cal-title{font-size:24px;font-weight:700}
.cal-nav{display:flex;align-items:center;gap:12px}
.cal-nav button{background:#1a1a1a;border:1px solid #333;color:#e8e8e8;padding:6px 14px;border-radius:6px;cursor:pointer;font-size:14px;transition:all .2s}
.cal-nav button:hover{border-color:#ff5f1f;color:#ff5f1f}
.cal-month-label{font-size:18px;font-weight:600;min-width:160px;text-align:center}
.view-toggle{display:flex;gap:4px;background:#1a1a1a;border-radius:6px;padding:3px;border:1px solid #333}
.view-toggle button{background:transparent;border:none;color:#888;padding:6px 14px;border-radius:4px;cursor:pointer;font-size:13px;transition:all .2s}
.view-toggle button.active{background:#ff5f1f;color:#fff}
.view-toggle button:hover:not(.active){color:#e8e8e8}
.today-btn{background:#1a1a1a;border:1px solid #333;color:#e8e8e8;padding:6px 14px;border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s}
.today-btn:hover{border-color:#ff5f1f;color:#ff5f1f}

/* Calendar Grid */
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:#222;border:1px solid #222;border-radius:8px;overflow:hidden}
.cal-day-header{background:#1a1a1a;padding:8px 4px;text-align:center;font-size:12px;font-weight:600;color:#888;text-transform:uppercase}
.cal-cell{background:#141414;min-height:100px;padding:6px;cursor:pointer;transition:background .2s;position:relative;display:flex;flex-direction:column}
.cal-cell:hover{background:#1a1a1a}
.cal-cell.other-month{opacity:.35}
.cal-cell.today{box-shadow:inset 0 0 0 2px #ff5f1f}
.cal-cell .day-num{font-size:13px;font-weight:600;margin-bottom:4px;color:#999}
.cal-cell.today .day-num{color:#ff5f1f}
.cal-cell .posts-area{flex:1;display:flex;flex-direction:column;gap:2px;overflow:hidden}
.post-chip{display:flex;align-items:center;gap:4px;padding:2px 4px;border-radius:3px;font-size:10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer;transition:background .15s}
.post-chip:hover{background:rgba(255,255,255,.08)}
.post-chip .dot{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.post-chip .chip-text{overflow:hidden;text-overflow:ellipsis;flex:1}
.post-chip .chip-status{width:5px;height:5px;border-radius:50%;flex-shrink:0;margin-left:auto}
.more-posts{font-size:10px;color:#888;text-align:center;margin-top:2px}

/* Week View */
.cal-grid.week-view{grid-template-columns:repeat(7,1fr)}
.cal-grid.week-view .cal-cell{min-height:300px}

/* Platform Colors */
.plat-twitter{background:#1DA1F2}
.plat-instagram{background:#E4405F}
.plat-linkedin{background:#0A66C2}
.plat-tiktok{background:#69C9D0}
.plat-facebook{background:#1877F2}
.plat-youtube{background:#FF0000}

/* Status Colors */
.status-draft{background:#666}
.status-scheduled{background:#ff5f1f}
.status-posted{background:#10b981}

/* Sidebar */
.sidebar-section{background:#141414;border:1px solid #222;border-radius:8px;padding:16px;margin-bottom:16px}
.sidebar-title{font-size:14px;font-weight:700;margin-bottom:12px;color:#ff5f1f;text-transform:uppercase;letter-spacing:.5px}
.stat-row{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px solid #1a1a1a;font-size:13px}
.stat-row:last-child{border-bottom:none}
.stat-label{color:#999}
.stat-value{font-weight:600}
.stat-dot{width:8px;height:8px;border-radius:50%;display:inline-block;margin-right:6px}
.platform-stat{display:flex;align-items:center;gap:6px}

/* Templates */
.template-list{display:flex;flex-direction:column;gap:6px}
.template-btn{background:#1a1a1a;border:1px solid #282828;color:#ccc;padding:8px 10px;border-radius:6px;cursor:pointer;font-size:12px;text-align:left;transition:all .2s;display:flex;align-items:center;gap:8px}
.template-btn:hover{border-color:#ff5f1f;color:#ff5f1f}
.template-icon{font-size:14px;width:20px;text-align:center}

/* Export */
.export-btns{display:flex;gap:8px;flex-wrap:wrap}
.export-btn{background:#1a1a1a;border:1px solid #333;color:#e8e8e8;padding:8px 14px;border-radius:6px;cursor:pointer;font-size:12px;transition:all .2s;flex:1;text-align:center}
.export-btn:hover{border-color:#ff5f1f;color:#ff5f1f}

/* Modal Overlay */
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.7);z-index:200;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .2s}
.modal-overlay.open{opacity:1;pointer-events:auto}
.modal{background:#1a1a1a;border:1px solid #333;border-radius:12px;width:90%;max-width:520px;max-height:90vh;overflow-y:auto;padding:24px;position:relative}
.modal-title{font-size:18px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;justify-content:space-between}
.modal-close{background:none;border:none;color:#888;font-size:24px;cursor:pointer;padding:0 4px;line-height:1;transition:color .2s}
.modal-close:hover{color:#ff5f1f}

/* Form */
.form-group{margin-bottom:14px}
.form-label{display:block;font-size:12px;font-weight:600;color:#999;margin-bottom:6px;text-transform:uppercase;letter-spacing:.3px}
.form-input,.form-textarea,.form-select{width:100%;background:#111;border:1px solid #333;color:#e8e8e8;padding:10px 12px;border-radius:6px;font-size:14px;font-family:inherit;transition:border-color .2s}
.form-input:focus,.form-textarea:focus,.form-select:focus{outline:none;border-color:#ff5f1f}
.form-textarea{resize:vertical;min-height:80px}
.form-select{cursor:pointer;-webkit-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23888' d='M6 8L1 3h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center}
.form-select option{background:#1a1a1a;color:#e8e8e8}

/* Platform Checkboxes */
.platform-checks{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
.plat-check{display:flex;align-items:center;gap:6px;padding:6px 8px;border-radius:6px;cursor:pointer;transition:background .15s;font-size:13px;border:1px solid transparent}
.plat-check:hover{background:rgba(255,255,255,.05)}
.plat-check input{display:none}
.plat-check .check-dot{width:10px;height:10px;border-radius:50%;border:2px solid #444;transition:all .2s}
.plat-check input:checked+.check-dot{border-color:transparent}
.plat-check[data-plat="twitter"] input:checked+.check-dot{background:#1DA1F2;box-shadow:0 0 6px #1DA1F244}
.plat-check[data-plat="instagram"] input:checked+.check-dot{background:#E4405F;box-shadow:0 0 6px #E4405F44}
.plat-check[data-plat="linkedin"] input:checked+.check-dot{background:#0A66C2;box-shadow:0 0 6px #0A66C244}
.plat-check[data-plat="tiktok"] input:checked+.check-dot{background:#69C9D0;box-shadow:0 0 6px #69C9D044}
.plat-check[data-plat="facebook"] input:checked+.check-dot{background:#1877F2;box-shadow:0 0 6px #1877F244}
.plat-check[data-plat="youtube"] input:checked+.check-dot{background:#FF0000;box-shadow:0 0 6px #FF000044}

/* Action Buttons */
.btn-primary{background:#ff5f1f;border:none;color:#fff;padding:10px 20px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s;width:100%}
.btn-primary:hover{background:#e5551b;transform:translateY(-1px)}
.btn-danger{background:transparent;border:1px solid #ef4444;color:#ef4444;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:13px;transition:all .2s}
.btn-danger:hover{background:#ef4444;color:#fff}
.modal-actions{display:flex;gap:10px;margin-top:16px;align-items:center}
.modal-actions .btn-primary{flex:1}

/* Email Modal */
.email-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);z-index:300;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s}
.email-overlay.open{opacity:1;pointer-events:auto}
.email-box{background:#1a1a1a;border:1px solid #333;border-radius:12px;width:90%;max-width:420px;padding:28px;text-align:center}
.email-box h3{font-size:20px;margin-bottom:6px}
.email-box p{color:#999;font-size:14px;margin-bottom:16px}
.email-row{display:flex;gap:8px}
.email-row input{flex:1;background:#111;border:1px solid #333;color:#e8e8e8;padding:10px 14px;border-radius:6px;font-size:14px}
.email-row input:focus{outline:none;border-color:#ff5f1f}
.email-row button{background:#ff5f1f;border:none;color:#fff;padding:10px 18px;border-radius:6px;cursor:pointer;font-weight:600;font-size:14px}
.email-skip{background:none;border:none;color:#666;font-size:12px;cursor:pointer;margin-top:12px;padding:4px}
.email-skip:hover{color:#999}

/* Toast */
.toast{position:fixed;bottom:24px;right:24px;background:#1a1a1a;border:1px solid #333;color:#e8e8e8;padding:12px 20px;border-radius:8px;font-size:13px;z-index:400;transform:translateY(80px);opacity:0;transition:all .3s;pointer-events:none}
.toast.show{transform:translateY(0);opacity:1}
.toast.success{border-color:#10b981}
.toast.error{border-color:#ef4444}

/* Footer */
.footer{text-align:center;padding:30px 20px;color:#555;font-size:13px;border-top:1px solid #151515;margin-top:40px}
.footer a{color:#ff5f1f}

/* Responsive */
@media(max-width:900px){
  .app-container{flex-direction:column}
  .sidebar{width:100%;order:-1}
  .sidebar-sections{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px}
  .sidebar-section{margin-bottom:0}
  .cal-cell{min-height:70px;padding:4px}
  .post-chip{font-size:9px;padding:1px 3px}
  .cal-day-header{font-size:10px;padding:6px 2px}
}
@media(max-width:600px){
  .cal-header{flex-direction:column;align-items:stretch}
  .cal-nav{justify-content:center}
  .platform-checks{grid-template-columns:repeat(2,1fr)}
  .cal-cell{min-height:56px}
  .day-num{font-size:11px!important}
}
</style>
</head>
<body>

<!-- Nav -->
<nav class="nav">
  <div class="nav-left">
    <a href="/" class="nav-brand">SpunkArt</a>
    <a href="/tools" class="nav-back">&larr; All Tools</a>
  </div>
</nav>

<!-- App -->
<div class="app-container">
  <!-- Main Calendar -->
  <div class="main-area">
    <div class="cal-header">
      <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap">
        <h1 class="cal-title">Content Calendar</h1>
        <div class="view-toggle">
          <button class="active" id="monthViewBtn" onclick="setView('month')">Month</button>
          <button id="weekViewBtn" onclick="setView('week')">Week</button>
        </div>
        <button class="today-btn" onclick="goToday()">Today</button>
      </div>
      <div class="cal-nav">
        <button onclick="navMonth(-1)">&larr; Prev</button>
        <span class="cal-month-label" id="monthLabel"></span>
        <button onclick="navMonth(1)">Next &rarr;</button>
      </div>
    </div>
    <div class="cal-grid" id="calGrid"></div>
  </div>

  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-sections">
      <!-- Stats -->
      <div class="sidebar-section">
        <div class="sidebar-title">Stats This Month</div>
        <div id="statsArea"></div>
      </div>

      <!-- Templates -->
      <div class="sidebar-section">
        <div class="sidebar-title">Content Templates</div>
        <div class="template-list" id="templateList"></div>
      </div>

      <!-- Export -->
      <div class="sidebar-section">
        <div class="sidebar-title">Export</div>
        <div class="export-btns">
          <button class="export-btn" onclick="copyAllPosts()">Copy as Text</button>
          <button class="export-btn" onclick="downloadCSV()">Download CSV</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Post Modal -->
<div class="modal-overlay" id="postModal">
  <div class="modal">
    <div class="modal-title">
      <span id="modalTitle">Add Post</span>
      <button class="modal-close" onclick="closeModal()">&times;</button>
    </div>
    <form id="postForm" onsubmit="return savePost(event)">
      <input type="hidden" id="postId">
      <input type="hidden" id="postDate">

      <div class="form-group">
        <label class="form-label">Platforms</label>
        <div class="platform-checks">
          <label class="plat-check" data-plat="twitter"><input type="checkbox" name="platform" value="twitter"><span class="check-dot"></span>X / Twitter</label>
          <label class="plat-check" data-plat="instagram"><input type="checkbox" name="platform" value="instagram"><span class="check-dot"></span>Instagram</label>
          <label class="plat-check" data-plat="linkedin"><input type="checkbox" name="platform" value="linkedin"><span class="check-dot"></span>LinkedIn</label>
          <label class="plat-check" data-plat="tiktok"><input type="checkbox" name="platform" value="tiktok"><span class="check-dot"></span>TikTok</label>
          <label class="plat-check" data-plat="facebook"><input type="checkbox" name="platform" value="facebook"><span class="check-dot"></span>Facebook</label>
          <label class="plat-check" data-plat="youtube"><input type="checkbox" name="platform" value="youtube"><span class="check-dot"></span>YouTube</label>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Post Type</label>
        <select class="form-select" id="postType">
          <option value="text">Text Post</option>
          <option value="image">Image Post</option>
          <option value="video">Video</option>
          <option value="story">Story</option>
          <option value="thread">Thread</option>
          <option value="carousel">Carousel</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">Content / Caption</label>
        <textarea class="form-textarea" id="postContent" placeholder="Write your post content here..." rows="4"></textarea>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
        <div class="form-group">
          <label class="form-label">Status</label>
          <select class="form-select" id="postStatus">
            <option value="draft">Draft</option>
            <option value="scheduled">Scheduled</option>
            <option value="posted">Posted</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Time (optional)</label>
          <input type="time" class="form-input" id="postTime">
        </div>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn-danger" id="deleteBtn" onclick="deletePost()" style="display:none">Delete</button>
        <button type="submit" class="btn-primary" id="saveBtn">Add Post</button>
      </div>
    </form>
  </div>
</div>

<!-- Email Modal -->
<div class="email-overlay" id="emailOverlay">
  <div class="email-box">
    <h3>Loving the Calendar?</h3>
    <p>Get free content planning tips, templates, and social media strategies weekly.</p>
    <div class="email-row">
      <input type="email" id="emailInput" placeholder="you@example.com">
      <button onclick="submitEmail()">Subscribe</button>
    </div>
    <button class="email-skip" onclick="closeEmail()">No thanks, maybe later</button>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- Footer -->
<footer class="footer">
  &copy; 2025 <a href="https://spunkart.com">SpunkArt</a> &middot; <a href="https://x.com/SpunkArt13" target="_blank" rel="noopener">@SpunkArt13</a>
</footer>

<script>
(function(){
/* ===== State ===== */
const MONTHS=['January','February','March','April','May','June','July','August','September','October','November','December'];
const DAYS=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
const PLATFORM_COLORS={twitter:'#1DA1F2',instagram:'#E4405F',linkedin:'#0A66C2',tiktok:'#69C9D0',facebook:'#1877F2',youtube:'#FF0000'};
const PLATFORM_NAMES={twitter:'X/Twitter',instagram:'Instagram',linkedin:'LinkedIn',tiktok:'TikTok',facebook:'Facebook',youtube:'YouTube'};
const STATUS_COLORS={draft:'#666',scheduled:'#ff5f1f',posted:'#10b981'};

const TEMPLATES=[
  {icon:'\u{1F525}',name:'Monday Motivation',content:'Start your week strong!\n\n[Inspirational quote or message]\n\nWhat are you working toward this week? Drop it below.\n\n#MondayMotivation #NewWeek'},
  {icon:'\u{1F4A1}',name:'Tip Tuesday',content:'Quick tip for you:\n\n[Share a valuable tip relevant to your audience]\n\nSave this for later! \n\n#TipTuesday #ProTip'},
  {icon:'\u{1F3AC}',name:'Behind the Scenes',content:'Here\'s a peek behind the curtain...\n\n[Share what you\'re working on, your process, or workspace]\n\nWhat would you like to see more of? Let me know!\n\n#BehindTheScenes #BTS'},
  {icon:'\u{2B50}',name:'Product Feature',content:'Did you know?\n\n[Highlight a specific feature or benefit of your product/service]\n\nTry it out and let me know what you think!\n\n#ProductUpdate #Feature'},
  {icon:'\u{1F4AC}',name:'Customer Story',content:'Shoutout to [customer/client]!\n\n[Share their story, testimonial, or result]\n\nLove hearing stories like this. What\'s your experience been?\n\n#CustomerStory #Testimonial'},
  {icon:'\u{1F4CA}',name:'Poll / Question',content:'Quick question for you:\n\n[Ask an engaging question or create a poll]\n\nA) Option 1\nB) Option 2\nC) Option 3\nD) Option 4\n\nDrop your answer below!'},
  {icon:'\u{1F4F8}',name:'Throwback Thursday',content:'Throwback to [when]!\n\n[Share a memory, old photo, or milestone]\n\nHow far we\'ve come. What\'s your favorite throwback?\n\n#ThrowbackThursday #TBT'},
  {icon:'\u{1F389}',name:'Weekend Promo',content:'Weekend special!\n\n[Details of your offer, discount, or promotion]\n\nValid this weekend only. Don\'t miss out!\n\nLink in bio.\n\n#WeekendDeal #SpecialOffer'}
];

let currentYear, currentMonth, currentView='month', currentWeekStart=null;
let posts=[];
let editingId=null;
let sessionCounted=false;

/* ===== Storage ===== */
function loadPosts(){
  try{const d=localStorage.getItem('spunkart_social_calendar_posts');posts=d?JSON.parse(d):[];}catch(e){posts=[];}
}
function savePosts(){
  try{localStorage.setItem('spunkart_social_calendar_posts',JSON.stringify(posts));}catch(e){}
}
function getUses(){return parseInt(localStorage.getItem('spunkart_social_calendar_uses')||'0',10);}
function setUses(n){localStorage.setItem('spunkart_social_calendar_uses',String(n));}
function emailDone(){return localStorage.getItem('spunkart_social_calendar_email_done')==='1';}
function setEmailDone(){localStorage.setItem('spunkart_social_calendar_email_done','1');}

/* ===== Init ===== */
const now=new Date();
currentYear=now.getFullYear();
currentMonth=now.getMonth();
loadPosts();
renderAll();
buildTemplates();

/* ===== Calendar Rendering ===== */
function renderAll(){
  renderCalendar();
  renderStats();
  updateMonthLabel();
}

function updateMonthLabel(){
  const el=document.getElementById('monthLabel');
  if(currentView==='month'){
    el.textContent=MONTHS[currentMonth]+' '+currentYear;
  }else{
    const ws=currentWeekStart||getWeekStart(now);
    const we=new Date(ws);we.setDate(we.getDate()+6);
    const fmt=d=>(MONTHS[d.getMonth()].substring(0,3)+' '+d.getDate());
    el.textContent=fmt(ws)+' - '+fmt(we)+', '+ws.getFullYear();
  }
}

function getWeekStart(date){
  const d=new Date(date);d.setHours(0,0,0,0);
  const day=d.getDay();
  d.setDate(d.getDate()-day);
  return d;
}

function renderCalendar(){
  const grid=document.getElementById('calGrid');
  grid.innerHTML='';
  grid.classList.toggle('week-view',currentView==='week');

  // Day headers
  DAYS.forEach(d=>{
    const h=document.createElement('div');
    h.className='cal-day-header';h.textContent=d;
    grid.appendChild(h);
  });

  if(currentView==='month') renderMonthCells(grid);
  else renderWeekCells(grid);
}

function renderMonthCells(grid){
  const firstDay=new Date(currentYear,currentMonth,1).getDay();
  const daysInMonth=new Date(currentYear,currentMonth+1,0).getDate();
  const prevMonthDays=new Date(currentYear,currentMonth,0).getDate();
  const todayStr=formatDate(now);

  // Prev month fill
  for(let i=firstDay-1;i>=0;i--){
    const day=prevMonthDays-i;
    const d=new Date(currentYear,currentMonth-1,day);
    const cell=makeCell(d,true);
    grid.appendChild(cell);
  }
  // Current month
  for(let d=1;d<=daysInMonth;d++){
    const date=new Date(currentYear,currentMonth,d);
    const dateStr=formatDate(date);
    const cell=makeCell(date,false,dateStr===todayStr);
    grid.appendChild(cell);
  }
  // Next month fill
  const totalCells=firstDay+daysInMonth;
  const rows=Math.ceil(totalCells/7);
  const fill=rows*7-totalCells;
  for(let d=1;d<=fill;d++){
    const date=new Date(currentYear,currentMonth+1,d);
    const cell=makeCell(date,true);
    grid.appendChild(cell);
  }
}

function renderWeekCells(grid){
  if(!currentWeekStart) currentWeekStart=getWeekStart(now);
  const todayStr=formatDate(now);
  for(let i=0;i<7;i++){
    const date=new Date(currentWeekStart);
    date.setDate(date.getDate()+i);
    const dateStr=formatDate(date);
    const cell=makeCell(date,false,dateStr===todayStr);
    grid.appendChild(cell);
  }
}

function makeCell(date,otherMonth,isToday){
  const dateStr=formatDate(date);
  const cell=document.createElement('div');
  cell.className='cal-cell'+(otherMonth?' other-month':'')+(isToday?' today':'');
  cell.onclick=()=>openModal(dateStr);

  const dayNum=document.createElement('div');
  dayNum.className='day-num';
  dayNum.textContent=date.getDate();
  cell.appendChild(dayNum);

  const postsArea=document.createElement('div');
  postsArea.className='posts-area';

  const dayPosts=posts.filter(p=>p.date===dateStr).sort((a,b)=>(a.time||'').localeCompare(b.time||''));
  const maxShow=currentView==='week'?12:3;

  dayPosts.slice(0,maxShow).forEach(p=>{
    const chip=document.createElement('div');
    chip.className='post-chip';
    chip.onclick=e=>{e.stopPropagation();openModal(dateStr,p.id);};

    p.platforms.forEach(pl=>{
      const dot=document.createElement('span');
      dot.className='dot';
      dot.style.background=PLATFORM_COLORS[pl]||'#888';
      chip.appendChild(dot);
    });

    const text=document.createElement('span');
    text.className='chip-text';
    text.textContent=(p.time?p.time+' ':'')+truncate(p.content,20);
    chip.appendChild(text);

    const st=document.createElement('span');
    st.className='chip-status';
    st.style.background=STATUS_COLORS[p.status]||'#666';
    st.title=p.status;
    chip.appendChild(st);

    postsArea.appendChild(chip);
  });

  if(dayPosts.length>maxShow){
    const more=document.createElement('div');
    more.className='more-posts';
    more.textContent='+'+(dayPosts.length-maxShow)+' more';
    postsArea.appendChild(more);
  }

  cell.appendChild(postsArea);
  return cell;
}

/* ===== Stats ===== */
function renderStats(){
  const area=document.getElementById('statsArea');
  const monthPosts=posts.filter(p=>{
    const d=new Date(p.date+'T00:00:00');
    return d.getFullYear()===currentYear && d.getMonth()===currentMonth;
  });

  let html='<div class="stat-row"><span class="stat-label">Total posts</span><span class="stat-value">'+monthPosts.length+'</span></div>';

  // Per platform
  const platCounts={};
  Object.keys(PLATFORM_COLORS).forEach(p=>platCounts[p]=0);
  monthPosts.forEach(p=>p.platforms.forEach(pl=>{platCounts[pl]=(platCounts[pl]||0)+1;}));
  Object.entries(platCounts).forEach(([pl,c])=>{
    if(c>0) html+='<div class="stat-row"><span class="platform-stat"><span class="stat-dot" style="background:'+PLATFORM_COLORS[pl]+'"></span>'+PLATFORM_NAMES[pl]+'</span><span class="stat-value">'+c+'</span></div>';
  });

  // Status breakdown
  const statusCounts={draft:0,scheduled:0,posted:0};
  monthPosts.forEach(p=>statusCounts[p.status]=(statusCounts[p.status]||0)+1);
  html+='<div style="border-top:1px solid #222;margin:8px 0"></div>';
  Object.entries(statusCounts).forEach(([s,c])=>{
    html+='<div class="stat-row"><span class="platform-stat"><span class="stat-dot" style="background:'+STATUS_COLORS[s]+'"></span>'+s.charAt(0).toUpperCase()+s.slice(1)+'</span><span class="stat-value">'+c+'</span></div>';
  });

  area.innerHTML=html;
}

/* ===== Templates ===== */
function buildTemplates(){
  const list=document.getElementById('templateList');
  TEMPLATES.forEach(t=>{
    const btn=document.createElement('button');
    btn.className='template-btn';
    btn.innerHTML='<span class="template-icon">'+t.icon+'</span>'+t.name;
    btn.onclick=()=>useTemplate(t);
    list.appendChild(btn);
  });
}

function useTemplate(t){
  const today=formatDate(now);
  openModal(today);
  document.getElementById('postContent').value=t.content;
  document.getElementById('postType').value='text';
}

/* ===== Modal ===== */
function openModal(dateStr,postId){
  editingId=null;
  const modal=document.getElementById('postModal');
  const form=document.getElementById('postForm');
  form.reset();
  document.querySelectorAll('.plat-check input').forEach(c=>c.checked=false);
  document.getElementById('postId').value='';
  document.getElementById('postDate').value=dateStr;
  document.getElementById('deleteBtn').style.display='none';
  document.getElementById('saveBtn').textContent='Add Post';
  document.getElementById('modalTitle').textContent='Add Post - '+formatDateDisplay(dateStr);

  if(postId){
    const post=posts.find(p=>p.id===postId);
    if(post){
      editingId=post.id;
      document.getElementById('postId').value=post.id;
      document.getElementById('postType').value=post.type||'text';
      document.getElementById('postContent').value=post.content||'';
      document.getElementById('postStatus').value=post.status||'draft';
      document.getElementById('postTime').value=post.time||'';
      post.platforms.forEach(pl=>{
        const cb=document.querySelector('.plat-check[data-plat="'+pl+'"] input');
        if(cb) cb.checked=true;
      });
      document.getElementById('deleteBtn').style.display='block';
      document.getElementById('saveBtn').textContent='Update Post';
      document.getElementById('modalTitle').textContent='Edit Post - '+formatDateDisplay(dateStr);
    }
  }

  modal.classList.add('open');
  setTimeout(()=>document.getElementById('postContent').focus(),100);
}

function closeModal(){
  document.getElementById('postModal').classList.remove('open');
  editingId=null;
}

function savePost(e){
  e.preventDefault();
  const platforms=[];
  document.querySelectorAll('.plat-check input:checked').forEach(c=>platforms.push(c.value));
  if(platforms.length===0){showToast('Select at least one platform','error');return false;}

  const content=document.getElementById('postContent').value.trim();
  if(!content){showToast('Add some content','error');return false;}

  const postData={
    id:editingId||generateId(),
    date:document.getElementById('postDate').value,
    platforms:platforms,
    type:document.getElementById('postType').value,
    content:content,
    status:document.getElementById('postStatus').value,
    time:document.getElementById('postTime').value||''
  };

  if(editingId){
    const idx=posts.findIndex(p=>p.id===editingId);
    if(idx>=0) posts[idx]=postData;
    showToast('Post updated','success');
  }else{
    posts.push(postData);
    showToast('Post added','success');
    trackUse();
  }

  savePosts();
  closeModal();
  renderAll();
  return false;
}

function deletePost(){
  if(!editingId) return;
  if(!confirm('Delete this post?')) return;
  posts=posts.filter(p=>p.id!==editingId);
  savePosts();
  closeModal();
  renderAll();
  showToast('Post deleted','success');
}

/* ===== Navigation ===== */
function navMonth(dir){
  if(currentView==='month'){
    currentMonth+=dir;
    if(currentMonth>11){currentMonth=0;currentYear++;}
    if(currentMonth<0){currentMonth=11;currentYear--;}
  }else{
    if(!currentWeekStart) currentWeekStart=getWeekStart(now);
    currentWeekStart.setDate(currentWeekStart.getDate()+(dir*7));
    currentYear=currentWeekStart.getFullYear();
    currentMonth=currentWeekStart.getMonth();
  }
  renderAll();
}
window.navMonth=navMonth;

function goToday(){
  currentYear=now.getFullYear();
  currentMonth=now.getMonth();
  currentWeekStart=getWeekStart(now);
  renderAll();
}
window.goToday=goToday;

function setView(v){
  currentView=v;
  document.getElementById('monthViewBtn').classList.toggle('active',v==='month');
  document.getElementById('weekViewBtn').classList.toggle('active',v==='week');
  if(v==='week' && !currentWeekStart) currentWeekStart=getWeekStart(now);
  renderAll();
}
window.setView=setView;

/* ===== Export ===== */
function copyAllPosts(){
  const monthPosts=posts.filter(p=>{
    const d=new Date(p.date+'T00:00:00');
    return d.getFullYear()===currentYear && d.getMonth()===currentMonth;
  }).sort((a,b)=>a.date.localeCompare(b.date)||(a.time||'').localeCompare(b.time||''));

  if(!monthPosts.length){showToast('No posts this month','error');return;}

  let text=MONTHS[currentMonth]+' '+currentYear+' - Social Media Calendar\n'+('=').repeat(50)+'\n\n';
  monthPosts.forEach(p=>{
    text+=formatDateDisplay(p.date)+(p.time?' at '+p.time:'')+'\n';
    text+='Platforms: '+p.platforms.map(pl=>PLATFORM_NAMES[pl]).join(', ')+'\n';
    text+='Type: '+p.type+' | Status: '+p.status+'\n';
    text+=p.content+'\n';
    text+=('-').repeat(40)+'\n\n';
  });

  navigator.clipboard.writeText(text).then(()=>showToast('Copied to clipboard','success')).catch(()=>{
    const ta=document.createElement('textarea');ta.value=text;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);showToast('Copied to clipboard','success');
  });
}
window.copyAllPosts=copyAllPosts;

function downloadCSV(){
  const monthPosts=posts.filter(p=>{
    const d=new Date(p.date+'T00:00:00');
    return d.getFullYear()===currentYear && d.getMonth()===currentMonth;
  }).sort((a,b)=>a.date.localeCompare(b.date)||(a.time||'').localeCompare(b.time||''));

  if(!monthPosts.length){showToast('No posts this month','error');return;}

  let csv='Date,Time,Platforms,Type,Status,Content\n';
  monthPosts.forEach(p=>{
    const content='"'+p.content.replace(/"/g,'""')+'"';
    csv+=p.date+','+p.time+','+('"'+p.platforms.map(pl=>PLATFORM_NAMES[pl]).join(', ')+'"')+','+p.type+','+p.status+','+content+'\n';
  });

  const blob=new Blob([csv],{type:'text/csv'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;a.download='content-calendar-'+MONTHS[currentMonth].toLowerCase()+'-'+currentYear+'.csv';
  document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);
  showToast('CSV downloaded','success');
}
window.downloadCSV=downloadCSV;

/* ===== Usage Tracking ===== */
function trackUse(){
  if(sessionCounted) return;
  sessionCounted=true;
  const uses=getUses()+1;
  setUses(uses);
  if(uses>=2 && !emailDone()){
    setTimeout(()=>document.getElementById('emailOverlay').classList.add('open'),800);
  }
}

/* ===== Email ===== */
function submitEmail(){
  const email=document.getElementById('emailInput').value.trim();
  if(!email||!email.includes('@')){showToast('Enter a valid email','error');return;}
  const form=new FormData();form.append('email',email);
  fetch('https://app.beehiiv.com/forms/6831d05b-f121-4e0d-951b-16f88ddd9ec3',{method:'POST',body:new URLSearchParams({email:email}),headers:{'Content-Type':'application/x-www-form-urlencoded'}}).catch(()=>{});
  setEmailDone();
  closeEmail();
  showToast('Subscribed! Check your inbox','success');
}
window.submitEmail=submitEmail;

function closeEmail(){
  document.getElementById('emailOverlay').classList.remove('open');
  setEmailDone();
}
window.closeEmail=closeEmail;

/* ===== Helpers ===== */
function formatDate(d){
  return d.getFullYear()+'-'+String(d.getMonth()+1).padStart(2,'0')+'-'+String(d.getDate()).padStart(2,'0');
}

function formatDateDisplay(dateStr){
  const parts=dateStr.split('-');
  const d=new Date(parseInt(parts[0]),parseInt(parts[1])-1,parseInt(parts[2]));
  return DAYS[d.getDay()]+', '+MONTHS[d.getMonth()]+' '+d.getDate()+', '+d.getFullYear();
}

function truncate(s,n){return s.length>n?s.substring(0,n)+'...':s;}

function generateId(){return 'p_'+Date.now()+'_'+Math.random().toString(36).substring(2,8);}

function showToast(msg,type){
  const t=document.getElementById('toast');
  t.textContent=msg;
  t.className='toast '+(type||'')+' show';
  clearTimeout(t._timer);
  t._timer=setTimeout(()=>t.classList.remove('show'),2500);
}

/* Keyboard shortcuts */
document.addEventListener('keydown',e=>{
  if(e.key==='Escape'){
    if(document.getElementById('emailOverlay').classList.contains('open')) closeEmail();
    else if(document.getElementById('postModal').classList.contains('open')) closeModal();
  }
});

/* Close modal on overlay click */
document.getElementById('postModal').addEventListener('click',e=>{if(e.target===e.currentTarget)closeModal();});
document.getElementById('emailOverlay').addEventListener('click',e=>{if(e.target===e.currentTarget)closeEmail();});

/* Expose for onclick handlers */
window.openModal=openModal;
window.closeModal=closeModal;
window.deletePost=deletePost;
})();
</script>

<!-- Analytics: GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GVNL11PEGP"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-GVNL11PEGP');</script>
<!-- Clarity -->
<script>(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y)})(window,document,"clarity","script","pn0x1z2y3w");</script>
<!-- Code Protection -->
<script>!function(){const h=e=>{e.preventDefault();return false};document.addEventListener('contextmenu',h);document.addEventListener('keydown',e=>{if((e.ctrlKey||e.metaKey)&&(e.key==='u'||e.key==='s'||e.key==='c'&&e.shiftKey)){e.preventDefault();}if(e.key==='F12')e.preventDefault();});}();</script>
</body>
</html>